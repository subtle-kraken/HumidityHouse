function updateFirebaseData() {
  var sheet = SpreadsheetApp.getActiveSpreadsheet().getActiveSheet();
  var url = "https://esp32-data-xxxxxxxxxxxxxxxxxxxxxxxxxx.firebasedatabase.app/data.json";  // âš ï¸ Remplace avec ton URL Firebase

  try {
    var response = UrlFetchApp.fetch(url);
    var json = JSON.parse(response.getContentText());

    var temp = json.temperature;
    var hum = json.humidity;
    var date = new Date();

    // ğŸ”¹ Calcul de l'humiditÃ© absolue
    var ah = (6.112 * Math.exp((17.67 * temp) / (temp + 243.5)) * hum * 2.1674) / (273.15 + temp);

    // ğŸ”¹ Ajouter une nouvelle ligne avec les valeurs formatÃ©es
    sheet.appendRow([date, temp, hum, ah]);

    Logger.log("âœ… DonnÃ©es mises Ã  jour !");
  } catch (e) {
    Logger.log("âŒ Erreur : " + e.toString());
  }
}
